{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/vsvij/Desktop/MERN Projects/social-media/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/vsvij/Desktop/MERN Projects/social-media/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport axios from \"axios\";\nimport baseUrl from \"./baseUrl\";\nimport catchErrors from \"./catchErrors\";\nimport Router from \"next/router\";\nimport cookie from \"js-cookie\";\nexport var registerUser = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(user, profilePicUrl, setError, setLoading) {\n    var res, errorMsg;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return axios.post(\"\".concat(baseUrl, \"/api/signup\"), {\n              user: user,\n              profilePicUrl: profilePicUrl\n            });\n\n          case 3:\n            res = _context.sent;\n            setToken(res.data);\n            _context.next = 11;\n            break;\n\n          case 7:\n            _context.prev = 7;\n            _context.t0 = _context[\"catch\"](0);\n            errorMsg = catchErrors(_context.t0);\n            setError(errorMsg);\n\n          case 11:\n            setLoading(false);\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[0, 7]]);\n  }));\n\n  return function registerUser(_x, _x2, _x3, _x4) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var loginUser = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(user, setError, setLoading) {\n    var res, errorMsg;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            setLoading(true);\n            _context2.prev = 1;\n            _context2.next = 4;\n            return axios.post(\"\".concat(baseUrl, \"/api/auth\"), {\n              user: user\n            });\n\n          case 4:\n            res = _context2.sent;\n            setToken(res.data);\n            _context2.next = 12;\n            break;\n\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](1);\n            errorMsg = catchErrors(_context2.t0);\n            setError(errorMsg);\n\n          case 12:\n            setLoading(false);\n\n          case 13:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[1, 8]]);\n  }));\n\n  return function loginUser(_x5, _x6, _x7) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var redirectUser = function redirectUser(ctx, location) {\n  if (ctx.req) {\n    ctx.res.writeHead(302, {\n      Location: location\n    });\n    ctx.res.end();\n  } else {\n    Router.push(location);\n  }\n};\nexport var logoutUser = function logoutUser(email) {\n  cookie.set(\"userEmail\", email);\n  cookie.remove(\"token\");\n  Router.push(\"/login\");\n  Router.reload();\n};\n\nvar setToken = function setToken(token) {\n  cookie.set(\"token\", token);\n  Router.push(\"/\");\n};","map":{"version":3,"sources":["C:/Users/vsvij/Desktop/MERN Projects/social-media/utils/authUser.js"],"names":["axios","baseUrl","catchErrors","Router","cookie","registerUser","user","profilePicUrl","setError","setLoading","post","res","setToken","data","errorMsg","loginUser","redirectUser","ctx","location","req","writeHead","Location","end","push","logoutUser","email","set","remove","reload","token"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AAEA,OAAO,IAAMC,YAAY;AAAA,sEAAG,iBAAOC,IAAP,EAAaC,aAAb,EAA4BC,QAA5B,EAAsCC,UAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAENT,KAAK,CAACU,IAAN,WAAcT,OAAd,kBAAoC;AAAEK,cAAAA,IAAI,EAAJA,IAAF;AAAQC,cAAAA,aAAa,EAAbA;AAAR,aAApC,CAFM;;AAAA;AAElBI,YAAAA,GAFkB;AAIxBC,YAAAA,QAAQ,CAACD,GAAG,CAACE,IAAL,CAAR;AAJwB;AAAA;;AAAA;AAAA;AAAA;AAMlBC,YAAAA,QANkB,GAMPZ,WAAW,aANJ;AAOxBM,YAAAA,QAAQ,CAACM,QAAD,CAAR;;AAPwB;AAS1BL,YAAAA,UAAU,CAAC,KAAD,CAAV;;AAT0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAZJ,YAAY;AAAA;AAAA;AAAA,GAAlB;AAYP,OAAO,IAAMU,SAAS;AAAA,uEAAG,kBAAOT,IAAP,EAAaE,QAAb,EAAuBC,UAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AACvBA,YAAAA,UAAU,CAAC,IAAD,CAAV;AADuB;AAAA;AAAA,mBAGHT,KAAK,CAACU,IAAN,WAAcT,OAAd,gBAAkC;AAAEK,cAAAA,IAAI,EAAJA;AAAF,aAAlC,CAHG;;AAAA;AAGfK,YAAAA,GAHe;AAKrBC,YAAAA,QAAQ,CAACD,GAAG,CAACE,IAAL,CAAR;AALqB;AAAA;;AAAA;AAAA;AAAA;AAOfC,YAAAA,QAPe,GAOJZ,WAAW,cAPP;AAQrBM,YAAAA,QAAQ,CAACM,QAAD,CAAR;;AARqB;AAUvBL,YAAAA,UAAU,CAAC,KAAD,CAAV;;AAVuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAATM,SAAS;AAAA;AAAA;AAAA,GAAf;AAaP,OAAO,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAMC,QAAN,EAAmB;AAC7C,MAAID,GAAG,CAACE,GAAR,EAAa;AACXF,IAAAA,GAAG,CAACN,GAAJ,CAAQS,SAAR,CAAkB,GAAlB,EAAuB;AAAEC,MAAAA,QAAQ,EAAEH;AAAZ,KAAvB;AACAD,IAAAA,GAAG,CAACN,GAAJ,CAAQW,GAAR;AACD,GAHD,MAGO;AACLnB,IAAAA,MAAM,CAACoB,IAAP,CAAYL,QAAZ;AACD;AACF,CAPM;AASP,OAAO,IAAMM,UAAU,GAAG,SAAbA,UAAa,CAAAC,KAAK,EAAI;AACjCrB,EAAAA,MAAM,CAACsB,GAAP,CAAW,WAAX,EAAwBD,KAAxB;AACArB,EAAAA,MAAM,CAACuB,MAAP,CAAc,OAAd;AACAxB,EAAAA,MAAM,CAACoB,IAAP,CAAY,QAAZ;AACApB,EAAAA,MAAM,CAACyB,MAAP;AACD,CALM;;AAOP,IAAMhB,QAAQ,GAAG,SAAXA,QAAW,CAAAiB,KAAK,EAAI;AACxBzB,EAAAA,MAAM,CAACsB,GAAP,CAAW,OAAX,EAAoBG,KAApB;AACA1B,EAAAA,MAAM,CAACoB,IAAP,CAAY,GAAZ;AACD,CAHD","sourcesContent":["import axios from \"axios\";\r\nimport baseUrl from \"./baseUrl\";\r\nimport catchErrors from \"./catchErrors\";\r\nimport Router from \"next/router\";\r\nimport cookie from \"js-cookie\";\r\n\r\nexport const registerUser = async (user, profilePicUrl, setError, setLoading) => {\r\n  try {\r\n    const res = await axios.post(`${baseUrl}/api/signup`, { user, profilePicUrl });\r\n\r\n    setToken(res.data);\r\n  } catch (error) {\r\n    const errorMsg = catchErrors(error);\r\n    setError(errorMsg);\r\n  }\r\n  setLoading(false);\r\n};\r\n\r\nexport const loginUser = async (user, setError, setLoading) => {\r\n  setLoading(true);\r\n  try {\r\n    const res = await axios.post(`${baseUrl}/api/auth`, { user });\r\n\r\n    setToken(res.data);\r\n  } catch (error) {\r\n    const errorMsg = catchErrors(error);\r\n    setError(errorMsg);\r\n  }\r\n  setLoading(false);\r\n};\r\n\r\nexport const redirectUser = (ctx, location) => {\r\n  if (ctx.req) {\r\n    ctx.res.writeHead(302, { Location: location });\r\n    ctx.res.end();\r\n  } else {\r\n    Router.push(location);\r\n  }\r\n};\r\n\r\nexport const logoutUser = email => {\r\n  cookie.set(\"userEmail\", email);\r\n  cookie.remove(\"token\");\r\n  Router.push(\"/login\");\r\n  Router.reload();\r\n};\r\n\r\nconst setToken = token => {\r\n  cookie.set(\"token\", token);\r\n  Router.push(\"/\");\r\n};\r\n"]},"metadata":{},"sourceType":"module"}